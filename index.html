<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Odečty domů</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    table, th, td { border: 1px solid gray; border-collapse: collapse; padding: 4px; }
    input, select { margin: 5px; }
    #app, #loginError { display: none; }
  </style>
</head>
<body>

<h2>Odečty domů</h2>

<div id="login">
  <p>Zadej heslo:</p>
  <input type="password" id="passwordInput">
  <button onclick="checkPassword()">Přihlásit</button>
  <p id="loginError" style="color: red;">Špatné heslo!</p>
</div>

<div id="app">
  <label for="dumSelect">Vyber dům:</label>
  <select id="dumSelect">
    <option value="Dům1">Dům1</option>
    <option value="Dům2">Dům2</option>
    <option value="Dům3">Dům3</option>
    <option value="Dům4">Dům4</option>
    <option value="Dům5">Dům5</option>
  </select>
  <button onclick="loadData()">Načíst odečty</button>

  <h3>Odečty</h3>
  <table id="dataTable"></table>
</div>

<script>
  const PASSWORD = "tajne123";
  const scriptURL = "https://script.google.com/macros/s/1v9QlVwpcxMFfm6-DKsc47Js-pYGcvAE5HrmVQTU43XLy51VO6mKjMlZZ/exec";

  function checkPassword() {
    const input = document.getElementById("passwordInput").value;
    if (input === PASSWORD) {
      document.getElementById("login").style.display = "none";
      document.getElementById("app").style.display = "block";
    } else {
      document.getElementById("loginError").style.display = "block";
    }
  }

  async function loadData() {
    const dum = document.getElementById("dumSelect").value;
    const res = await fetch(`${scriptURL}?dum=${encodeURIComponent(dum)}`);
    const data = await res.json();

    const table = document.getElementById("dataTable");
    table.innerHTML = "";

    if (data.length === 0) {
      table.innerHTML = "<tr><td>Žádná data</td></tr>";
      return;
    }

    const headers = Object.keys(data[0]);
    table.innerHTML += `<tr>${headers.map(h => `<th>${h}</th>`).join("")}</tr>`;
    data.reverse().forEach(row => {
      table.innerHTML += `<tr>${headers.map(h => `<td>${row[h]}</td>`).join("")}</tr>`;
    });
  }
</script>

</body>
</html>
